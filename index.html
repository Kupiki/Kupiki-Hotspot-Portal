<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Captive Portal</title>

    <!-- Bootstrap -->
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
    <!-- Bootstrap material design theme -->
    <link rel="stylesheet" type="text/css" href="css/material.min.css">

    <script src="js/ChilliLibrary.js"></script>
    <script type="application/javascript">

        chilliController.host = "192.168.10.1"; // Hard Coding - not a good idea
        chilliController.port = "3990";
        chilliController.interval = 60;

        chilliController.onError = handleErrors;
        chilliController.onUpdate = updateUI;

        var loginUrl;
        function redirect() { window.location = loginUrl; return false; }

        /* Action triggered when buttons are pressed */
        function connect() {
            var username =  document.getElementById('username').value ;
            var password =  document.getElementById('password').value ;

            if (username == null || username == '')
                return setElementValue('logonMessage', 'Username is required');


            //showWaitPage(1000);
            chilliController.logon( username , password ) ;
        }

        function updateUI (cmd) {
            //alert('You called the method' + cmd + '\n Your current state is =' + chilliController.clientState);
            if (chilliController.clientState == 1) {
                //alert('Connected')
                window.location = "http://www.pihomeserver.fr";
            }
        }

        // If an error occurs, this handler will be called instead
        function handleErrors (code) {
            alert('The last contact with the Controller failed. Error code =' + code );
        }

        //  finally, get current state
        chilliController.refresh();
    </script>
</head>
<body>

<nav class="navbar navbar-default shadow-z-1">
    <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="javascript:void(0)">KUPIKI Captive Portal</a>
    </div>
</nav>

<div class="container">
    <div class="row" style="margin-top: 25px;">
        <div class="col-xs-8 col-xs-offset-2 col-md-4 col-md-offset-4 panel panel-default" style="padding: 55px;">
            <form class="form-horizontal" action="javascript:connect()">
                <fieldset>
                    <div class="form-group">
                        <input id="username" class="form-control" type="text" name="username" placeholder="Username" autofocus>
                    </div>
                    <br>
                    <div class="form-group">
                        <input id="password" class="form-control" type="password" name="password" placeholder="Password">
                    </div>
                    <br>
                    <div class="form-group">
                        <a>Forgot the password?</a>
                    </div>
                    <div class="form-group">
                        <button class="btn btn-primary" type="submit">Login</button>
                    </div>
                </fieldset>
            </form>
        </div>
    </div>
</div>

<script src="js/jquery.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/material.min.js"></script>

<script type="text/javascript">
    $.material.init(); // Init material design effect
</script>
</body>
</html>